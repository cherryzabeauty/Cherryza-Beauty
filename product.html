<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details - Cherryza Beauty</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        cherry: {
                            50: '#fdf2f8',
                            100: '#fce7f3',
                            200: '#fbcfe8',
                            300: '#f9a8d4',
                            400: '#f472b6',
                            500: '#ec4899',
                            600: '#db2777',
                            700: '#be185d',
                            800: '#9d174d',
                            900: '#831843',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    }
                }
            }
        }
    </script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:wght@400;600;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        h1,
        h2,
        h3 {
            font-family: 'Playfair Display', serif;
        }

        .glass-nav {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        }
    </style>
</head>

<body class="bg-cherry-50 text-gray-800">

    <!-- Navigation -->
    <nav class="glass-nav fixed w-full z-50 top-0 transition-all duration-300" id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <div class="flex-shrink-0 flex items-center">
                    <a href="index.html" class="text-3xl font-bold text-cherry-800 tracking-wider">Cherryza.</a>
                </div>
                <!-- Desktop Menu -->
                <div class="hidden md:flex space-x-8 items-center">
                    <a href="index.html" class="text-gray-700 hover:text-cherry-600 transition font-medium">Home</a>
                    <a href="shop.html" class="text-gray-700 hover:text-cherry-600 transition font-medium">Shop</a>
                    <a href="about.html" class="text-gray-700 hover:text-cherry-600 transition font-medium">About</a>
                    <a href="contact.html"
                        class="text-gray-700 hover:text-cherry-600 transition font-medium">Contact</a>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- Search Bar -->
                    <form action="shop.html" method="GET"
                        class="hidden md:flex items-center border border-gray-300 rounded-full px-3 py-1 bg-white/50 hover:bg-white transition focus-within:ring-1 ring-cherry-400">
                        <input type="text" name="search" placeholder="Search products..."
                            class="bg-transparent border-none focus:outline-none text-sm w-40 placeholder-gray-500 text-gray-700">
                        <button type="submit" class="text-gray-500 hover:text-cherry-600 ml-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                            </svg>
                        </button>
                    </form>
                    <a href="cart.html" class="relative text-gray-700 hover:text-cherry-600 transition">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                        </svg>
                        <span id="cart-count"
                            class="absolute -top-2 -right-2 bg-cherry-600 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center">0</span>
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Product Details Section -->
    <div class="pt-32 pb-12 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div id="product-container" class="bg-white rounded-2xl shadow-xl overflow-hidden min-h-[60vh]">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-0 md:gap-8">

                <!-- Image Gallery -->
                <div class="p-6 md:p-8 bg-gray-50">
                    <div class="mb-4 aspect-w-4 aspect-h-3 rounded-lg overflow-hidden bg-white shadow-sm">
                        <img id="main-image" src="" alt="Product Image"
                            class="w-full h-full object-center object-contain">
                    </div>
                    <!-- Thumbnails -->
                    <div id="thumbnails" class="flex gap-2 overflow-x-auto pb-2">
                        <!-- Injected via JS -->
                    </div>
                </div>

                <!-- Product Info -->
                <div class="p-6 md:p-12 flex flex-col justify-center">
                    <div class="mb-6">
                        <span id="product-category"
                            class="inline-block bg-cherry-100 text-cherry-800 text-xs px-2 py-1 rounded-full uppercase tracking-wide font-semibold mb-2">Category</span>
                        <h1 id="product-name" class="text-3xl md:text-4xl font-bold text-gray-900 mb-2">Product Name
                        </h1>
                        <p id="product-price" class="text-2xl text-cherry-600 font-bold">LKR 0.00</p>
                    </div>

                    <div class="prose prose-sm text-gray-500 mb-8">
                        <p id="product-desc">Description goes here...</p>
                    </div>

                    <div class="mt-auto">
                        <div class="flex items-center space-x-4">
                            <div class="w-24">
                                <label class="sr-only">Quantity</label>
                                <input type="number" id="quantity" min="1" value="1"
                                    class="w-full border border-gray-300 rounded-lg px-3 py-2 text-center" disabled>
                            </div>
                            <button id="add-to-cart-btn"
                                class="flex-1 bg-gray-900 text-white px-8 py-3 rounded-lg font-bold hover:bg-cherry-600 transition shadow-lg transform active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed">
                                Add to Cart
                            </button>
                        </div>
                        <p id="stock-status" class="mt-2 text-sm text-gray-500">In Stock</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white mt-12">
        <div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <span class="text-2xl font-bold tracking-wider text-cherry-400">Cherryza.</span>
                <p class="mt-4 text-gray-400">&copy; 2024 Cherryza Beauty. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="js/data.js"></script>
    <script src="js/app.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            updateCartIcon();
            setupAutocomplete();

            const urlParams = new URLSearchParams(window.location.search);
            const id = parseInt(urlParams.get('id'));

            if (!id) {
                window.location.href = 'shop.html';
                return;
            }

            const products = getProducts();
            const product = products.find(p => p.id === id);

            if (!product) {
                document.getElementById('product-container').innerHTML = `
                    <div class="p-12 text-center">
                        <h2 class="text-2xl font-bold text-gray-700 mb-4">Product Not Found</h2>
                        <a href="shop.html" class="text-cherry-600 hover:underline">Return to Shop</a>
                    </div>
                `;
                return;
            }

            // Populate Data
            document.title = `${product.name} - Cherryza Beauty`;
            document.getElementById('product-name').innerText = product.name;
            document.getElementById('product-category').innerText = product.category;
            document.getElementById('product-price').innerText = formatCurrency(product.price, product.currency);
            document.getElementById('product-desc').innerText = product.description;

            // Stock Logic
            const btn = document.getElementById('add-to-cart-btn');
            const stockLabel = document.getElementById('stock-status');
            const qtyInput = document.getElementById('quantity');

            if (product.stock <= 0) {
                btn.disabled = true;
                btn.innerText = "Out of Stock";
                btn.classList.add('bg-gray-400');
                stockLabel.innerText = "Current unavailable";
                stockLabel.classList.add('text-red-500');
            } else {
                stockLabel.innerText = `${product.stock} items left in stock`;
                qtyInput.disabled = false;
                qtyInput.max = product.stock;

                btn.onclick = () => {
                    const qty = parseInt(qtyInput.value);
                    if (qty > 0 && qty <= product.stock) {
                        for (let i = 0; i < qty; i++) addToCart(product.id); // Simple loop re-use of addToCart
                    } else {
                        alert("Invalid quantity");
                    }
                };
            }

            // Image Gallery Logic
            const mainImg = document.getElementById('main-image');
            const thumbContainer = document.getElementById('thumbnails');

            // Gather all images (handle legacy single 'image' vs new 'images' array)
            let images = [];
            if (product.images && product.images.length > 0) {
                images = product.images;
            } else if (product.image) {
                images = [product.image];
            }

            if (images.length > 0) {
                mainImg.src = images[0];

                // Render thumbnails
                if (images.length > 1) {
                    thumbContainer.innerHTML = images.map((src, index) => `
                        <button onclick="changeMainImage('${src}', this)" 
                            class="flex-shrink-0 w-20 h-20 border-2 ${index === 0 ? 'border-cherry-600' : 'border-transparent'} rounded-md overflow-hidden hover:border-cherry-400 transition focus:outline-none">
                            <img src="${src}" class="w-full h-full object-cover">
                        </button>
                    `).join('');
                }
            } else {
                mainImg.src = 'https://via.placeholder.com/400x400?text=No+Image';
            }

            // Global function for thumbnail click
            window.changeMainImage = (src, btn) => {
                document.getElementById('main-image').src = src;
                // Update active border
                document.querySelectorAll('#thumbnails button').forEach(b => b.classList.replace('border-cherry-600', 'border-transparent'));
                btn.classList.replace('border-transparent', 'border-cherry-600');
            };
        });
    </script>
</body>

</html>